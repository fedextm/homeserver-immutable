{
  "ignition": {
    "version": "3.5.0"
  },
  "kernelArguments": {
    "shouldExist": [
      "mitigations=off",
      "net.ifnames=0",
      "biosdevname=0",
      "selinux=0",
      "audit=0"
    ],
    "shouldNotExist": [
      "mitigations=auto,nosmt"
    ]
  },
  "passwd": {
    "users": [
      {
        "name": "core",
        "passwordHash": "$y$j9T$KBYCUm.3CT4/GE.MH0bWi/$ld9p.8ZzLBFRBhhde7RmKCtOvRlxl1NwyteIADPZij/",
        "sshAuthorizedKeys": [
          "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDerW5/oq90/fUprncOcLmQL4iuKP06d9PsGdmVBAwpcZYayyW3/or5Q6eFgAmEOfQEpKiB2NgUb8FOjhAzp9TdG/TAODRSZ2IWkov7HoFC5yzwfC+hoh01v3ioBFO0wioPC3aT6IQg7w6i3bq0vktdhhP/8lvodgKuU39UTLnD4ftJ/BB4ZIAoJySI4ce5OMulZZr79RLhsQwrm7FFb+zTPc4OpGIe0VRgynHXadCpjGQaEEP26S9Pbzi0vNxGVCPjUMbEvVU244M3ZI2PFu6Y8eBBVyeFIKcavGgwPHwzHTXZjwjZsz1P2yo1T5qsv2H5sOBvGiPda+b3J0b6Z5DYRAaGWf5oMJ1xn/Jasr/0hU2SNBwfN9Sl/qZ+GPSeFZSjqAa1t5r8fFwnifX3rVrlbk2v6YShK02IjZQ/YRmfZ7kbybchop2Sml8hmBH2686fGlOTL5/aC4py0HM25Dqj8sJNydPO4f+OzN7QtXIPlcw0mjVhxifz4IiXLpbhwI8= fed@localhost.localdomain"
        ]
      },
      {
        "homeDir": "/var/mnt/data/containers_data/plex/plexmediaserver",
        "name": "plex",
        "shell": "/sbin/nologin"
      }
    ]
  },
  "storage": {
    "directories": [
      {
        "group": {
          "name": "core"
        },
        "path": "/var/mnt/data",
        "user": {
          "name": "core"
        },
        "mode": 511
      }
    ],
    "files": [
      {
        "path": "/etc/systemd/journald.conf",
        "contents": {
          "compression": "gzip",
          "source": "data:;base64,H4sIAAAAAAAC/1yRzW7iMBSF934NPwBhhpFm40WLBGohUhVTVVXVhRufBkv+iewbSvr0lUOAlF3y3Z9z7vHbY+iiV/adSQpRNRAtYjKJ4InJPhFcqY7PCeJPsb6ClbGQ5htisWZ3nTYkfGB8GVwbkZLokRiXUHb8aq2hMmiIzmjGZe/rB0+IB2UlavHPMV4pwtY4Q9PC3yJNKvddTCTmRVEUeUd2sgHaVQTEGYzWUm5jvOo8GYfxgMv/ZOracbnoFo67SnWskFMxwWdvAxmGUIu5C572jK9C/FJR74Lskw3NEMqFbcp0Q5bBp2DxG74oO8a2270+KdqLmcZhVp96B9ktDrD5vSA0PrpmAk+6N3RUJlNP5s/ixn+GKx3U4RAbxrfG5xDE4v+G8QpKD3uytZ8AAAD//7QzZ1A2AgAA"
        },
        "mode": 420
      },
      {
        "overwrite": true,
        "path": "/etc/resolv.conf",
        "contents": {
          "compression": "",
          "source": "data:,%23%20Generated%20by%20NetworkManager%0Asearch%20lan%0Anameserver%20192.168.3.201%0A"
        },
        "mode": 420
      },
      {
        "path": "/etc/systemd/zram-generator.conf",
        "contents": {
          "compression": "",
          "source": "data:;base64,IyBUaGlzIGNvbmZpZyBmaWxlIGVuYWJsZXMgYSAvZGV2L3pyYW0wIGRldmljZSB3aXRoIHRoZSBkZWZhdWx0IHNldHRpbmdzClt6cmFtMF0K"
        },
        "mode": 420
      },
      {
        "path": "/var/lib/systemd/linger/core",
        "mode": 420
      },
      {
        "path": "/etc/ostree/auth.json",
        "contents": {
          "compression": "",
          "source": "data:;base64,ewoJImF1dGhzIjogewoJCSJnaGNyLmlvIjogewoJCQkiYXV0aCI6ICJabVZrWlhoMGJUcG5hSEJmU0d4UFdrZHFUbGhwU0ZsNlUyYzNOVlJqWWtrelJYaFVhWFJxZERWcE1UQm9XamhOIgoJCX0KCX0KfQ=="
        },
        "mode": 384
      },
      {
        "path": "/etc/hostname",
        "contents": {
          "compression": "",
          "source": "data:,homeserver.local"
        },
        "mode": 420
      },
      {
        "path": "/etc/sysctl.d/90-ipfw.conf",
        "contents": {
          "compression": "",
          "source": "data:,net.ipv4.ip_forward%20%3D%201%0A"
        }
      },
      {
        "path": "/etc/NetworkManager/system-connections/eth0.nmconnection",
        "contents": {
          "compression": "gzip",
          "source": "data:;base64,H4sIAAAAAAAC/2yNwQ6CMAyG7zyFLwC6SYge9iTEQ1l/ZMnWESgm+vTGGwv2+PXr19Nuep9F4DVkeVT7RWAHnS4F0/eMH8Ui0NIWxTKSRy2UcLz8ZIGbtyEGX/A+zK+2fEzMC9bVOHO3jelujbG2uZ5tW1gJOmV2iWSjeEh2x2T9hNQpMxxjpC3qvxyHlYYIrr4BAAD//+bWnfUjAQAA"
        },
        "mode": 384
      },
      {
        "path": "/etc/NetworkManager/system-connections/eth1.nmconnection",
        "contents": {
          "compression": "gzip",
          "source": "data:;base64,H4sIAAAAAAAC/2yOQU7DMBBF9zkFF4ip3VKBkE9SsRgyv4mleBzZE1A4PWKDMkq9/P/5z3vavdtQRDBoKvLR7YvEETp5k+m24C9FFailRVHvNKAXyjj+/CmCqHVtCjbFLS1fF3uZmCta89G/Beevry68nNz5OVwMxdL+gbMLJ/9u6pEU37SZDauUoVPhmElWmg9O16NTP0L6XBiRcad11kdznBp9zuCu+w0AAP//W57t3mYBAAA="
        },
        "mode": 384
      }
    ],
    "links": [
      {
        "path": "/etc/localtime",
        "target": "../usr/share/zoneinfo/Europe/Warsaw"
      }
    ]
  },
  "systemd": {
    "units": [
      {
        "enabled": false,
        "name": "systemd-resolved.service"
      },
      {
        "contents": "[Unit]\nDescription=Rebase to main image\nConditionFirstBoot=true\nAfter=network-online.target\n\n[Install]\nWantedBy=default.target\n\n[Service]\nType=oneshot\nRemainAfterExit=yes\nExecStartPre=/bin/sleep 30\nExecStartPre=systemctl disable zincati\nExecStart=rpm-ostree rebase --bypass-driver --reboot ostree-unverified-registry:ghcr.io/fedextm/homeserver:v0.6\nExecStartPost=/usr/bin/chown 1000:1000 /var/mnt/data\n",
        "enabled": true,
        "name": "rebase.service"
      },
      {
        "contents": "[Unit]\nDescription=Mount Data Volume\n\n[Mount]\nWhat=/dev/mapper/vg_data-lv_data\nWhere=/var/mnt/data\nType=ext4\nOptions=nofail,noatime,discard,errors=remount-ro\n\n[Install]\nWantedBy=multi-user.target",
        "enabled": true,
        "name": "var-mnt-data.mount"
      }
    ]
  }
}
